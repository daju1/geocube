<!doctype s-function-doc system "s-function-doc.dtd" [
<!entity % S-OLD "INCLUDE">
]
>
<s-function-doc>
<s-topics>
  <s-topic>fit.lmc</s-topic>
</s-topics>

<s-title>
Fit a Linear Model of Coregionalization to a Multivariable Sample Variogram
</s-title>

<s-description>
Fit a Linear Model of Coregionalization to a Multivariable Sample Variogram;
in case of a single variogram model (i.e., no nugget) this is equivalent to
Intrinsic Correlation
</s-description>

<s-usage>
<s-old-style-usage>
fit.lmc(v, g, model, fit.ranges = FALSE, fit.lmc = !fit.ranges, ...) 
</s-old-style-usage>
</s-usage>

<s-args>
<s-arg name="v">
multivariable sample variogram, output of <s-function name="variogram">variogram</s-function> </s-arg>
<s-arg name="g">
gstat object, output of <s-function name="gstat">gstat</s-function> </s-arg>
<s-arg name="model">
variogram model, output of <s-function name="vgm">vgm</s-function>; if supplied 
this value is used as initial value for each fit </s-arg>
<s-arg name="fit.ranges">
logical; determines whether the range coefficients
(excluding that of the nugget component) should be fitted; or logical
vector: determines for each range parameter of the variogram model
whether it should be fitted or fixed. </s-arg>
<s-arg name="fit.lmc">
logical; if TRUE, each coefficient matrices of partial
sills is guaranteed to be positive definite </s-arg>
<s-arg name="...">
parameters that get passed to <s-function name="fit.variogram">fit.variogram</s-function> </s-arg>
</s-args>

<s-value>
returns an object of class <s-expression>gstat</s-expression>, with fitted variograms;
</s-value>

<s-section name="NOTE">
This function does not use the iterative procedure proposed by
M. Goulard and M. Voltz (Math. Geol., 24(3): 269-286; reproduced in
Goovaerts' 1997 book) but uses simply two steps: first, each variogram
model is fitted to a direct or cross variogram; next each of the partial
sill coefficient matrices is approached by its in least squares sense
closest positive definite matrices (by setting any negative eigenvalues
to zero).
</s-section>

<s-section name="AUTHOR(S)">
Edzer J. Pebesma
</s-section>

<s-section name="REFERENCES">
<url url ="http://www.gstat.org/">
</s-section>

<s-see>
<s-function name="variogram">variogram</s-function>, <s-function name="vgm">vgm</s-function>, <s-function name="fit.variogram">fit.variogram</s-function>,
<s-expression>demo(cokriging)</s-expression>
</s-see>

<s-examples>
<s-example type = text>
</s-example>
</s-examples>
<s-docclass>
function
</s-docclass>
</s-function-doc>
